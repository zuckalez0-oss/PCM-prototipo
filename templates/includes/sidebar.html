<aside x-data="{ collapsed: false }" :class="collapsed ? 'w-20' : 'w-72'"
    class="hidden md:flex flex-col h-full bg-slate-900 border-r border-slate-800 text-white transition-all duration-300 relative z-20 shadow-xl">
    <!-- Logo -->
    <div class="h-16 flex items-center justify-between px-6 border-b border-slate-800/50">
        <div class="flex items-center gap-3 overflow-hidden whitespace-nowrap">
            <div
                class="w-8 h-8 rounded-lg bg-brand-500 flex items-center justify-center shrink-0 shadow-lg shadow-brand-500/20">
                <i class="ph-bold ph-microchip text-white text-lg"></i>
            </div>
            <div :class="collapsed ? 'opacity-0 w-0' : 'opacity-100 w-auto'" class="transition-all duration-300">
                <h1 class="font-bold text-lg tracking-tight">LYPSYOS</h1>
                <p class="text-[10px] text-slate-400 font-medium uppercase tracking-wider">PCM System</p>
            </div>
        </div>
        <!-- Collapse Toggle -->
        <!-- <button 
            @click="collapsed = !collapsed" 
            class="text-slate-400 hover:text-white transition-colors p-1 rounded-md hover:bg-slate-800"
        >
            <i class="ph ph-caret-left" :class="collapsed ? 'rotate-180' : ''"></i>
        </button> -->
    </div>

    <!-- Nav Links -->
    <nav class="flex-1 overflow-y-auto py-6 px-3 space-y-1">

        <p :class="collapsed ? 'hidden' : 'block'"
            class="px-3 text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2 mt-2">Visão Geral</p>

        <a href="{% url 'dashboard_analitico' %}"
            class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-300 hover:text-white hover:bg-slate-800 transition-all group {% if 'dashboard' in request.path %}bg-brand-600/10 text-brand-400 border border-brand-500/20{% endif %}">
            <i
                class="ph ph-chart-line-up text-xl group-hover:text-brand-400 transition-colors {% if 'dashboard' in request.path %}text-brand-400{% endif %}"></i>
            <span :class="collapsed ? 'hidden' : 'block'" class="font-medium text-sm">Dashboard</span>
        </a>

        <!-- Temporarily disabling redundant link or pointing to same dashboard -->
        <!-- <a href="{% url 'dashboard_analitico' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-300 hover:text-white hover:bg-slate-800 transition-all group">
            <i class="ph ph-calendar-check text-xl group-hover:text-brand-400 transition-colors"></i>
            <span :class="collapsed ? 'hidden' : 'block'" class="font-medium text-sm">Cronograma</span>
        </a> -->

        <p :class="collapsed ? 'hidden' : 'block'"
            class="px-3 text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2 mt-6">Gestão</p>

        <!-- Pointing to kanban_view -->
        <a href="{% url 'kanban_view' %}"
            class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-300 hover:text-white hover:bg-slate-800 transition-all group {% if 'kanban' in request.path %}bg-brand-600/10 text-brand-400 border border-brand-500/20{% endif %}">
            <i
                class="ph ph-squares-four text-xl group-hover:text-brand-400 transition-colors {% if 'kanban' in request.path %}text-brand-400{% endif %}"></i>
            <span :class="collapsed ? 'hidden' : 'block'" class="font-medium text-sm">Ativos / O.S.</span>
        </a>




    </nav>

    {% if user.is_superuser %}
    <a href="/admin/" target="_blank"
        class="flex items-center gap-3 px-3 py-2.5 mb-2 rounded-lg text-slate-400 hover:text-white hover:bg-slate-800 transition-all group">
        <i class="ph ph-wrench text-xl group-hover:text-brand-400 transition-colors"></i>
        <span :class="collapsed ? 'hidden' : 'block'" class="font-medium text-xs">Manutenção (Admin)</span>
    </a>
    {% endif %}

    <!-- User Profile / Footer -->
    <div class="p-4 border-t border-slate-800/50 bg-slate-900/50">
        <div class="flex items-center gap-3">
            <div
                class="w-10 h-10 rounded-full bg-slate-700 flex items-center justify-center text-white ring-2 ring-slate-800">
                <span class="font-bold">{{ user.username|first|upper }}</span>
            </div>
            <div :class="collapsed ? 'hidden' : 'block'" class="overflow-hidden">
                <p class="text-sm font-medium text-white truncate">{{ user.first_name|default:user.username }}</p>
                <a href="{% url 'logout' %}"
                    class="text-xs text-slate-400 hover:text-brand-400 transition-colors flex items-center gap-1">
                    <i class="ph-bold ph-sign-out"></i> Sair do sistema
                </a>
            </div>
        </div>
    </div>
</aside>

<!-- Mobile Sidebar Overlay & Menu -->
<div x-data="{ mobileMenuOpen: false }" class="md:hidden">
    <!-- Trigger in Navbar will toggle this -->
</div>