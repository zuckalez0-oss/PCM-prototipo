<div x-show="showRefuseModal" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-150"
    x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"
    class="fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm" style="display: none;">

    <div @click.away="showRefuseModal = false" x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0 scale-95 translate-y-4"
        x-transition:enter-end="opacity-100 scale-100 translate-y-0"
        class="bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 overflow-hidden border border-slate-200">

        <!-- Header -->
        <div class="bg-red-50 px-6 py-4 border-b border-red-100 flex items-center gap-3">
            <div class="w-10 h-10 rounded-full bg-red-100 flex items-center justify-center text-red-600">
                <i class="ph-bold ph-x-circle text-xl"></i>
            </div>
            <div>
                <h3 class="text-lg font-bold text-slate-800">Recusar Chamado</h3>
                <p class="text-xs text-slate-500">Informe o motivo da recusa.</p>
            </div>
        </div>

        <!-- Form -->
        {% comment %}
        Assuming 'chamado' context is passed if used in Chamado context,
        or 'atividade' if used in Atividade context.
        Adjusting for 'chamado' based on 'recusar_chamado' view signature.
        {% endcomment %}
        <form hx-post="{% url 'recusar_chamado' chamado.id|default:0 %}" hx-target="#kanban-container"
            hx-vals='{"view_mode": "board"}' hx-swap="innerHTML" @submit="showRefuseModal = false">

            <div class="p-6">
                <label for="motivo_{{ chamado.id }}" class="block text-sm font-semibold text-slate-700 mb-2">
                    Motivo da Recusa <span class="text-red-500">*</span>
                </label>
                <textarea id="motivo_{{ chamado.id }}" name="motivo" rows="3" required
                    class="w-full text-sm border-slate-300 rounded-lg focus:ring-red-500 focus:border-red-500 placeholder:text-slate-400"
                    placeholder="Ex: Não é responsabilidade da manutenção, Dados insuficientes..."></textarea>
            </div>

            <!-- Footer -->
            <div class="bg-slate-50 px-6 py-4 flex justify-end gap-3 border-t border-slate-100">
                <button type="button" @click="showRefuseModal = false"
                    class="px-4 py-2 text-sm font-semibold text-slate-600 hover:text-slate-800 hover:bg-slate-200 rounded-lg transition-colors">
                    Cancelar
                </button>
                <button type="submit"
                    class="px-4 py-2 text-sm font-bold text-white bg-red-500 hover:bg-red-600 rounded-lg shadow-sm transition-all transform active:scale-95 flex items-center gap-2">
                    <i class="ph-bold ph-trash"></i>
                    Recusar Definitivamente
                </button>
            </div>
        </form>
    </div>
</div>